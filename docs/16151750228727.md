# 微服务初开发笔记

Created: Aug 10, 2020 10:35 AM
Created By: Mario Copperfield
Last Edited By: Mario Copperfield
Last Edited Time: Aug 10, 2020 10:40 AM
Status: In Progress 🙌

# 微服务初开发笔记

> 初次开发微服务，或者说是初次开发Java Web，一切技术都显得那么新鲜(陌生)

> 连服务端的流程，架构都要自己设计，所以一开始是很懵逼的

## 准备工作

- 根据产品经理的需求文档，写服务端的设计与实现
- 设计数据库和业务表
- 设计API

### 服务端实现设计

需要理解产品提的需求，吃透每个功能点的操作，然后达成自己的理解

设计数据库和业务表，数据库的设计，每个公司有相应的规范文档，需要严格按照DBA的要求来完成

API的设计，对Web应用来说，主要的操作都是增删改查，前期设计个大概，在实现过程中不断迭代演化

功能流程图，指明一次操作的过程

在写服务端设计的时候，文档大概就包含了这几个方面，但是都经不起推敲，后续修改很大

### 数据库和业务表的设计和建立

公司的数据库规范不允许使用外键，因此需要靠关联表通过冗余实现一对多的映射关系

在此期间研究了一下乐观锁和悲观锁，通过create_time和modify_time实现

分布式的全局ID算法有待研究，比如Twitter的Snow Flake，不过公司的规范要求使用自增ID

### API设计

主要是增删改查操作，一期和项管对排期，只需实现了增查操作，也就是通常的insert、select和list操作

API可以通过Swagger设计，不过更方便的是在编程实现的时候通过Swagger的注解直接生成API，所以这一段的时间交了学费

API的细节参考了同事建议的Kong项目，list操作做了一点修改

### Jenkins实现CICD

git创建dev分支，每一次push，Jenkins能够自动拉取该分支，持续构建，这一步在测试前才开始做，经测试同学指导

关于git分支的划分，同事给了一篇blog可以看看

## 代码实现

> 公司有微服务框架，用Maven搭出整个项目的脚手架不算太难

> 刚接触Java Web开发，又是无数的新术语，就像刚毕业时做数据开发一样，需要一个个去理解

> 虽然听过MVC的概念，但是实践起来，还是无从下手，所以第一个微服务(Web 应用)基本是从模仿别人的项目开始的

### 不同的对象

写了一两天代码，才慢慢体会到Web的一个核心工作，就是在不同的层次间包装和拆包对象，形成本层能使用的X(X)O

在这次一期开发中，主要用到了几种对象: BO、PO、DTO和DAO，关于每个O的作用和功能，还需要继续学习领悟

### 分层

Spring开发，照猫画虎的简单方法就是通过注解，@Component的细化注解@RestController、@Service和@Repository，可以一气呵成地完成从Dao层->Service层->Controller